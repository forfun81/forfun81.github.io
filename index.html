<section id="crypto">
<h2>Crypto News</h2>
<div id="crypto-cards" style="display:flex; flex-wrap:wrap; gap:15px;"></div>
</section>

<script>
const rssURL = 'https://cointelegraph.com/rss';
const apiURL = `https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(rssURL)}`;
const CACHE_KEY = 'cryptoNewsCache';
const CACHE_TIME = 30*60*1000; // 30 min

function renderCard(item) {
    const div = document.createElement('div');
    div.style.border = '1px solid #ccc';
    div.style.borderRadius = '8px';
    div.style.width = '280px';
    div.style.padding = '10px';
    div.style.background = '#fff';
    div.style.cursor = 'pointer';
    div.style.boxShadow = '0 2px 5px rgba(0,0,0,0.1)';
    div.style.display = 'flex';
    div.style.flexDirection = 'column';
    div.style.transition = 'all 0.3s ease';
    
    div.onmouseover = () => div.style.boxShadow = '0 5px 15px rgba(0,0,0,0.2)';
    div.onmouseout = () => div.style.boxShadow = '0 2px 5px rgba(0,0,0,0.1)';
    
    let imgSrc = item.enclosure?.link || item.thumbnail || ''; // some feeds have image
    let imgTag = imgSrc ? `<img src="${imgSrc}" style="width:100%; height:150px; object-fit:cover; border-radius:5px 5px 0 0;">` : '';
    
    div.innerHTML = `
        ${imgTag}
        <h3 style="font-size:1.1em; margin:10px 0;">${item.title}</h3>
        <div class="desc" style="display:none; font-size:0.95em; color:#333;">${item.description}</div>
    `;
    
    div.addEventListener('click', () => {
        const descDiv = div.querySelector('.desc');
        descDiv.style.display = descDiv.style.display === 'none' ? 'block' : 'none';
        div.scrollIntoView({behavior:'smooth'});
    });
    
    return div;
}

function loadCrypto() {
    const cached = localStorage.getItem(CACHE_KEY);
    if(cached) {
        const obj = JSON.parse(cached);
        if(new Date().getTime() - obj.time < CACHE_TIME) {
            renderCrypto(obj.items);
            return;
        }
    }
    
    fetch(apiURL)
    .then(res => res.json())
    .then(data => {
        const items = data.items.slice(0,10);
        localStorage.setItem(CACHE_KEY, JSON.stringify({time:new Date().getTime(), items:items}));
        renderCrypto(items);
    })
    .catch(err => {
        console.error(err);
        document.getElementById('crypto-cards').innerHTML = 'Could not load Crypto News.';
    });
}

function renderCrypto(items) {
    const container = document.getElementById('crypto-cards');
    container.innerHTML = '';
    items.forEach(item => {
        container.appendChild(renderCard(item));
    });
}

loadCrypto();
setInterval(()=>{
    localStorage.removeItem(CACHE_KEY);
    loadCrypto();
}, CACHE_TIME);
</script>
